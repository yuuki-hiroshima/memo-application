{% extends "base.html" %}
{% block title %}カテゴリ管理{% endblock %}
{% block content %}
  <h1>カテゴリ管理</h1>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="flash-messages">
        <ul>
          {% for message in messages %}
          <li style="color: red;">
            {{ message }}
          </li>
        {% endfor %}
        </ul>
      </div>
    {% endif %}
  {% endwith %}

  <h2>新規カテゴリの作成</h2>
  <form action="/categories" method="POST" class="create-category-form">
    <input type="hidden" name="action" value="create">
    <input type="text" name="new_category" placeholder="カテゴリ名を入力" class="form-input">
    <button class="button button-primary">作成</button>
  </form>
      

  <table>
    <thead>
      <tr>
        <th>カテゴリ名</th>
        <th>件数</th>
        <th>名前変更</th>
        <th>削除</th>
      </tr>
    </thead>
    <tbody>
      {% for category_name, count in category_counts.items() %}
        <tr>
          <td>{{ category_name }}</td>
          <td>{{ count }}</td>
          <td>
            <form action="/categories" method="POST" class="rename-form">
              <input type="hidden" name="action" value="rename">
              <input type="hidden" name="old_name" value="{{ category_name }}">
              <input type="text" name="new_name" class="form-input" placeholder="新しい名前">
              <button class="button">変更</button>
            </form>
          </td>
          <td>
            <form action="/categories" method="POST">
              <input type="hidden" name="action" value="delete">
              <input type="hidden" name="target_name" value="{{ category_name }}">
              <button class="button button-danger" onclick="return confirm('「{{ category_name }}」を削除します。よろしいですか？')">削除</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  
{% endblock %}